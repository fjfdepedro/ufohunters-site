      <%
      if @listaUFO.coord
      %>
		<script type="text/javascript">
		   			
			var iconSize = new OpenLayers.Size(22, 22);			
		   var iconOffset = new OpenLayers.Pixel(-(iconSize.w / 2), -iconSize.h);
		   var icon = new OpenLayers.Icon("<%= image_path('platillo_negro.png') %>",
		                   iconSize, iconOffset);
			var iconSizeDetalle = new OpenLayers.Size(40, 40);
			var iconOffsetDetalle = new OpenLayers.Pixel(-(iconSizeDetalle.w / 2), -iconSizeDetalle.h);
			var iconDetalle = new OpenLayers.Icon("<%= image_path('platillo_verde.png') %>",
		                   iconSizeDetalle, iconOffsetDetalle);
		   var zoom, center, currentPopup, map, lyrMarkers;
		   var popupClass = OpenLayers.Class(OpenLayers.Popup.FramedCloud, {
		        "autoSize": true,
		        "minSize": new OpenLayers.Size(300, 50),
		        "maxSize": new OpenLayers.Size(500, 300),
		        "keepInMap": true
		    });
		   var bounds = new OpenLayers.Bounds();
		   var first = 0;
			var ua = navigator.userAgent;

		   function addMarker(lng, lat, info,icono) {
		   	var pt = new OpenLayers.LonLat(lng, lat).transform(new OpenLayers.Projection("EPSG:4326"),map.getProjectionObject());
		      bounds.extend(pt);
		      var feature = new OpenLayers.Feature(lyrMarkers, pt);
		      feature.closeBox = true;
		      feature.popupClass = popupClass;
		      feature.data.popupContentHTML = info;
		      feature.data.overflow = "auto";
				
		      var marker = new OpenLayers.Marker(pt, icon.clone());
		      if(first!=0) {
					if(icono==1) marker = new OpenLayers.Marker(pt,iconDetalle);
				   	var markerClick = function(evt) {
				      if (currentPopup != null && currentPopup.visible()) {
				      	currentPopup.hide();
				      }
				      if (this.popup == null) {
				         this.popup = this.createPopup(this.closeBox);
				         map.addPopup(this.popup);
				         this.popup.show();
				      } else {
				         this.popup.toggle();
				      }
				      currentPopup = this.popup;
				      OpenLayers.Event.stop(evt);
				   };

					var clickEvent = "click";

				   if(ua.match(/iPad/i) || ua.match(/iPhone/i) || ua.match(/webOS/i) || ua.match(/Mobile/i) ){
				     	clickEvent = "touchstart";
				   }
			    	marker.events.register(clickEvent, feature, markerClick);

				   lyrMarkers.addMarker(marker);
				}
		      first = 1;
		   }
		   
		   function init() {
		        
			   var zoom           = 8;
				 
			   var fromProjection = new OpenLayers.Projection("EPSG:4326");   // Transform from WGS 1984
			   var toProjection   = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
									
				var lat            = <%=@listaUFO.coord[1]%>;
				var lon            = <%=@listaUFO.coord[0]%>;
					
				var position = new OpenLayers.LonLat(lon, lat).transform( fromProjection, toProjection);
					
				map = new OpenLayers.Map("basicMap");
				var mapnik = new OpenLayers.Layer.OSM();
				map.addLayer(mapnik);
				 					
				lyrMarkers = new OpenLayers.Layer.Markers("Markers");
		        map.addLayer(lyrMarkers);
				var location = '';
				    
		      <% @listaUFOlist.each do |ovni|%>
            	location = "<%=ovni.location%>"; 			
               addMarker(<%=ovni.coord[0]%>,<%=ovni.coord[1]%>, '<strong>' + location + '</strong><br/><%= format_date ovni.sighted_at %><br/><strong><%= link_to "View sighting", :controller => "sightings", :action => "search", :id => ovni.id, :title => friendly_title(ovni) %></strong>',0);
				<% end %>
				    
				addMarker(lon, lat, null, 1);					
				map.setCenter(position, zoom);
		
		   }
		</script>
		<%
		end
		%>
	
	 	<div class="row">
		    <div class="span12">
			   	<%
	      		if @listaUFO.coord
	      		%>
					<div id="basicMap" style="width: 100%; height: 450px;"></div>
				<%
				end
				%>
		   	</div>
		</div>
		
	    <div class="row hidden-phone" style="margin-top: 20px;margin-bottom: 20px">
		    <div itemscope itemtype="http://schema.org/WPAdBlock" style="margin-left:auto;height:90px;text-align:center;margin-right:auto">
					<script type="text/javascript"><!--
						google_ad_client = "ca-pub-4760111415025425";
						/* Enlaces en la Home */
						google_ad_slot = "2151939683";
						google_ad_width = 970;
						google_ad_height = 90;
						//-->
					</script>
					<script type="text/javascript"
						src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
					</script>

		    </div>
	    </div>

		
		<div itemscope itemtype="http://schema.org/Article" class="row">	
				
				<div class="span8">
					<article>
						<meta itemprop="articleSection" content="UFO Sightings">
						<header>
							<h2 itemprop="name" class="title"><%= @listaUFO.location  %></h2>
						</header>
						<p class="meta">
						<small>Sighted on <strong itemprop="dateCreated" content="<%= format_date_microdata @listaUFO.sighted_at %>"><%= format_date @listaUFO.sighted_at %></strong><br/>
						Reported on <strong itemprop="datePublished" content="<%= format_date_microdata @listaUFO.reported_at %>"><%= format_date @listaUFO.reported_at %></strong><br/>
						Shape: <strong><%=@listaUFO.shape%></strong> | Duration: <strong><%=@listaUFO.duration%></strong><br/>
						Source: <span itemprop="author" itemscope itemtype="http://schema.org/Organization"><strong itemprop="name"><%=@listaUFO.source%></strong></span>
						<span itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
							<meta itemprop="name" content="ufo-hunters.com">
						</span>
						</small>
						</p>
						<div class="entry">
				   			<p itemprop="articleBody"><%=@listaUFO.description.html_safe%></p>
				   			<% unless @listaUFO.links.blank?	%>
				   				<script type="text/javascript">
			   					      $(document).ready(function() {
						                  $("#gallery").carousel({
						                     interval: 5000
						                  });
						              });
								</script>
				   				<%
				   				image_urls, other_urls = select_url_images(@listaUFO.links)

				   				unless image_urls.blank?
				   				%><h2>Images</h2>
				   					<div class="well" style="padding: 0">
                      					<div id="gallery" class="carousel slide" style="margin: 0">
                      						<div class="carousel-inner">
				   							    <%
				   							    img_cont = 0

				   							    image_urls.each do |img|

				   							  
				   							    	  if img_cont % 3 == 0 && img_cont ==0
				   							          %>	
							   								<div class="item <%= "active" if img_cont == 0 %>">
							   								    <div class="row-fluid" style="margin-left: 50px;">								   								
						   						      <%
									                  end
										             
										              if img_cont % 3 == 0 && img_cont !=0
				   							          %>	
							   									</div>
							   								</div>
							   								<div class="item">
							   								    <div class="row-fluid" style="margin-left: 50px;">								   								
						   						      <%
									                  end
										              %>				
										              				<div class="span3">
										              					<a href="<%=img%>">
									   												<figure>
									            								<img src="<%=img%>" alt="<%=@listaUFO.location%>" width="140" height="140" />
									            							</figure>
									        							</a>
									        						</div>
				        						      <%									                  

									                  if img 
				   							    	  	img_cont += 1
									                  end
				        					    end
				        					   %>
				        					   		  </div>
				   									</div>
				        					</div>
				        					<a class="left carousel-control" href="#gallery" data-slide="prev" style="background: none;border: 0;margin: 0; line-height: auto;top: 6px;font-weight: lighter;font-size: 70px">‹</a>
                         	<a class="right carousel-control" href="#gallery" data-slide="next" style="background: none;border: 0;margin: 0; line-height: auto;top: 6px;font-size: 70px">›</a>
				   						</div>				   						
				   					</div>
				   				<%
				   				end

				   				unless other_urls.blank?

				   					video_urls, other_urls = select_youtube_videos(other_urls)

				   					if video_urls
				   						%><h2>Videos</h2><%

					   					video_urls.each do |vid|
					   						%><%=youtube_video(vid)%><%	
					   					end

					   				end

				   					if other_urls

				   					%><h2>Related links</h2>
				   						<ul>
				   					<%
				   						other_urls.each do |link|
				   					%>
				   							<li><%= link_to link, link, :target => '_blank' %></li>
				   					<%
				   						end
				   					%>
				   					  </ul>
				   				<% 
				   					end

				   				end

				   			end 
				   			%>
	   						 
   						</div>
   					</article>

   					<div id="disqus_thread" style="margin-left:10px" class="row hidden-phone"></div>
					<script type="text/javascript">
				      var disqus_shortname = 'ufo-hunters'; // required: replace example with your forum shortname

				      (function() {
				         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				      })();
				   	</script>
	   				<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	   				<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

	   			</div>
	   			<div class="span4 hidden-phone" itemscope itemtype="http://schema.org/WPAdBlock">
					     		    <script type="text/javascript"><!--
										google_ad_client = "ca-pub-4760111415025425";
										google_ad_slot = "5862285686";
										google_ad_width = 300;
										google_ad_height = 600;
										//-->
									</script>
									<script type="text/javascript"
										src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
									</script>								

				</div>
	    </div>
		

	    <div class="row">
				<div class="span8">

				<% 
		     	if @listaUFOlist
		     	%>	
		     		<div class="" style="margin-top: 20px;margin-bottom: 20px">

		     			<h3>Nearest sightings sorted by proximity (100 miles radius):</h3>
		     			
				      			<table class="table table-responsive table-striped">
				      				<thead>
											<tr>
													<th>Location
													</th>
													<th>Sighted on
													</th>
													<th>Shape
													</th>
													<th class="hidden-phone">Duration
													</th>
											</tr>
									</thead>
									<tbody>
							     	<% 
							      	# In order to avoid the same sighting as nearest sighting
							      	@listaUFOlist.each do |ovni|
								      	if @listaUFO.id == ovni.id
								         	next
								       	end
										%>
							    			<tr itemprop="itemListElement" itemscope itemtype="http://schema.org/Article"> 
								         		<td itemprop="name">
								         			<%= link_to ovni.location, :controller => "sightings", :action => "search", :id => ovni.id, :title => friendly_title(ovni) %>
								         		</td>
								         		<td itemprop="dateCreated" content="<%= format_date_microdata ovni.sighted_at %>">
									    			<%= format_date ovni.sighted_at %>
									    		</td>
									    		<td>
									    			<%=ovni.shape%>
								         		</td>
								         		<td class="hidden-phone">
									    			<%= ovni.duration %>
								         		</td>
											</tr>
									<% 
									end 

									%>
								    </tbody>
								</table>
					</div>
 				
		     	<%
		        end
		        %>
			    </div>
			    <div class="span4 hidden-phone">

			 						<script type="text/javascript"><!--
										google_ad_client = "ca-pub-4760111415025425";
										google_ad_slot = "2708512888";
										google_ad_width = 300;
										google_ad_height = 600;
										//-->
									</script>
										<script type="text/javascript"
										src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
									</script>
			    </div>
	  	</div>
